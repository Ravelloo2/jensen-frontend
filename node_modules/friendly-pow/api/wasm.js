import { instantiateWasmSolver } from "../loader";
export async function getWasmSolver(module) {
    const w = await instantiateWasmSolver(module);
    const arrPtr = w.exports.__retain(w.exports.__allocArray(w.exports.Uint8Array_ID, new Uint8Array(128)));
    let solution = w.exports.__getUint8Array(arrPtr);
    return (puzzleBuffer, threshold, n = 4294967295) => {
        solution.set(puzzleBuffer);
        const hashPtr = w.exports.solveBlake2b(arrPtr, threshold, n);
        solution = w.exports.__getUint8Array(arrPtr);
        const hash = w.exports.__getUint8Array(hashPtr);
        w.exports.__release(hashPtr);
        return [solution, hash];
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2FzbS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcGkvd2FzbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMscUJBQXFCLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFFaEQsTUFBTSxDQUFDLEtBQUssVUFBVSxhQUFhLENBQUMsTUFBVztJQUMzQyxNQUFNLENBQUMsR0FBRyxNQUFNLHFCQUFxQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRTlDLE1BQU0sTUFBTSxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLElBQUksVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN4RyxJQUFJLFFBQVEsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUVqRCxPQUFPLENBQUMsWUFBd0IsRUFBRSxTQUFpQixFQUFFLENBQUMsR0FBRyxVQUFVLEVBQUUsRUFBRTtRQUNsRSxRQUF1QixDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUMzQyxNQUFNLE9BQU8sR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQzdELFFBQVEsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUM3QyxNQUFNLElBQUksR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNoRCxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM3QixPQUFPLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzVCLENBQUMsQ0FBQztBQUNOLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2luc3RhbnRpYXRlV2FzbVNvbHZlcn0gZnJvbSBcIi4uL2xvYWRlclwiO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFdhc21Tb2x2ZXIobW9kdWxlOiBhbnkpIHtcclxuICAgIGNvbnN0IHcgPSBhd2FpdCBpbnN0YW50aWF0ZVdhc21Tb2x2ZXIobW9kdWxlKTtcclxuXHJcbiAgICBjb25zdCBhcnJQdHIgPSB3LmV4cG9ydHMuX19yZXRhaW4ody5leHBvcnRzLl9fYWxsb2NBcnJheSh3LmV4cG9ydHMuVWludDhBcnJheV9JRCwgbmV3IFVpbnQ4QXJyYXkoMTI4KSkpO1xyXG4gICAgbGV0IHNvbHV0aW9uID0gdy5leHBvcnRzLl9fZ2V0VWludDhBcnJheShhcnJQdHIpO1xyXG5cclxuICAgIHJldHVybiAocHV6emxlQnVmZmVyOiBVaW50OEFycmF5LCB0aHJlc2hvbGQ6IG51bWJlciwgbiA9IDQyOTQ5NjcyOTUpID0+IHtcclxuICAgICAgICAoc29sdXRpb24gYXMgVWludDhBcnJheSkuc2V0KHB1enpsZUJ1ZmZlcik7XHJcbiAgICAgICAgY29uc3QgaGFzaFB0ciA9IHcuZXhwb3J0cy5zb2x2ZUJsYWtlMmIoYXJyUHRyLCB0aHJlc2hvbGQsIG4pO1xyXG4gICAgICAgIHNvbHV0aW9uID0gdy5leHBvcnRzLl9fZ2V0VWludDhBcnJheShhcnJQdHIpOyAgICAgICAgXHJcbiAgICAgICAgY29uc3QgaGFzaCA9IHcuZXhwb3J0cy5fX2dldFVpbnQ4QXJyYXkoaGFzaFB0cik7XHJcbiAgICAgICAgdy5leHBvcnRzLl9fcmVsZWFzZShoYXNoUHRyKTtcclxuICAgICAgICByZXR1cm4gW3NvbHV0aW9uLCBoYXNoXTtcclxuICAgIH07XHJcbn1cclxuIl19